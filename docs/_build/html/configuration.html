

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Configuration file &mdash; emubot  documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.png"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Facebook Messenger" href="chat_adapter/facebook_messenger.html" />
    <link rel="prev" title="Overview" href="overview.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #5E2028" >
          

          
            <a href="index.html" class="icon icon-home"> emubot
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Configuration file</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-structure">Basic structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exemplar-configuration-file">Exemplar Configuration File</a></li>
<li class="toctree-l2"><a class="reference internal" href="#messaging-platform-configuration">Messaging Platform Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#nlp-platform-configuration">NLP Platform Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multiple-agents">Multiple agents</a></li>
<li class="toctree-l2"><a class="reference internal" href="#best-practices">Best Practices</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Chat Adapters</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="chat_adapter/facebook_messenger.html">Facebook Messenger</a></li>
<li class="toctree-l1"><a class="reference internal" href="chat_adapter/slack.html">Slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="chat_adapter/cli_client.html">CLI Client Adapter</a></li>
<li class="toctree-l1"><a class="reference internal" href="chat_adapter/your_custom_chat_adapter.html">Support Your Chat Platform</a></li>
</ul>
<p class="caption"><span class="caption-text">Core</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="core/core_overview.html">Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="core/interfaces.html">Interceptors</a></li>
</ul>
<p class="caption"><span class="caption-text">NLP platforms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="nlp_adapter/dialogflow.html">Dialogflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_adapter/snips.html">Snips</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_adapter/rasa.html">Rasa</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_adapter/custom_nlp_adapter.html">Support Your NLP Platform</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="about_us.html">About Us</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">emubot</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Configuration file</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/configuration.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="configuration-file">
<span id="config-file"></span><h1>Configuration file<a class="headerlink" href="#configuration-file" title="Permalink to this headline">¶</a></h1>
<p>Central to your chatbot is its configuration file (which we will also call the <em>config</em>). In this file, you declare which messaging and NLP service you want to use and
include all information required to authenticate with the distinctive services.
You have to follow a predefined format specified in the <a class="reference external" href="../api_reference/miscellaneous/typealiases.html#Agent">Typings</a> of the framework.</p>
<p><strong>Important: Without a valid configuration file the framework will start in the default configuration. In default configuration the framework provides a simple communication test which is accessible through the</strong> <a class="reference external" href="chat_adapter/cli_client.html">CLI client</a>.</p>
<div class="section" id="basic-structure">
<h2>Basic structure<a class="headerlink" href="#basic-structure" title="Permalink to this headline">¶</a></h2>
<p>The minimum requirements necessary to start a bot are the specification of:</p>
<ol class="arabic simple">
<li><p>The variables required for the chat platform of your choice (<code class="code docutils literal notranslate"><span class="pre">config.platform.chat</span></code>).</p></li>
<li><p>The variables required for the NLP service of your choice (<code class="code docutils literal notranslate"><span class="pre">config.platform.nlp</span></code>).</p></li>
<li><p>The variables used to configure your server (<code class="code docutils literal notranslate"><span class="pre">config.server</span></code>).</p></li>
</ol>
<p>Furthermore, you can add more configuration variables for additional services, like a database.</p>
</div>
<div class="section" id="exemplar-configuration-file">
<h2>Exemplar Configuration File<a class="headerlink" href="#exemplar-configuration-file" title="Permalink to this headline">¶</a></h2>
<p>In this exemplar configuration file, we use the <a class="reference external" href="https://www.facebook.com/">Facebook</a> Messenger as our messaging platform and <a class="reference external" href="https://dialogflow.com/">Dialogflow</a> as
our NLP Service. We have also provided some configuration files for various combinations of messaging platforms and NLP services
<a class="reference external" href="https://github.com/emundo/emubot/tree/master/src/framework/configuration">here</a>. If you want to change the platforms, you can simply change the respective section (e.g. <code class="code docutils literal notranslate"><span class="pre">platform.chat</span></code>)
in the configuration file. More information on which variables you need for each platform and how you can get these variables can be found in the distinctive section
(see below for more information).</p>
<div class="highlight-javascript notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="kr">import</span> <span class="p">{</span><span class="nx">Config</span><span class="p">,</span> <span class="nx">FacebookAdapter</span><span class="p">,</span> <span class="nx">DialogflowV2Adapter</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;emubot&#39;</span>

 <span class="kr">export</span> <span class="kr">const</span> <span class="nx">config</span><span class="o">:</span> <span class="nx">Config</span><span class="o">&lt;</span><span class="nx">FacebookAdapter</span><span class="p">,</span> <span class="nx">DialogflowV2Adapter</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">{</span>
     <span class="nx">platform</span><span class="o">:</span> <span class="p">{</span>
         <span class="nx">chat</span><span class="o">:</span> <span class="p">{</span>
             <span class="nx">appSecret</span><span class="o">:</span> <span class="s1">&#39;YOUR_APP_SECRET&#39;</span><span class="p">,</span>
             <span class="nx">constructor</span><span class="o">:</span> <span class="nx">FacebookAdapter</span><span class="p">,</span>
             <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;facebook&#39;</span><span class="p">,</span>
             <span class="nx">pageAccessToken</span><span class="o">:</span>
                 <span class="s1">&#39;YOUR_FACEBOOK_PAGE_TOKEN&#39;</span><span class="p">,</span>
             <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;https://graph.facebook.com/&#39;</span><span class="p">,</span>
             <span class="nx">verifyToken</span><span class="o">:</span> <span class="s1">&#39;YOUR_FACEBOOK_VERIFY_TOKEN&#39;</span><span class="p">,</span>
             <span class="nx">version</span><span class="o">:</span> <span class="s1">&#39;v3.3&#39;</span><span class="p">,</span>
             <span class="nx">webhook_path</span><span class="o">:</span> <span class="s1">&#39;/webhook&#39;</span><span class="p">,</span>
         <span class="p">},</span>
         <span class="nx">nlp</span><span class="o">:</span> <span class="p">{</span>
             <span class="nx">agents</span><span class="o">:</span> <span class="p">{</span>
                 <span class="nx">name_of_first_agent</span><span class="o">:</span> <span class="p">{</span>
                     <span class="nx">defaultLifespan</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
                     <span class="nx">executionIndex</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
                     <span class="nx">languageCode</span><span class="o">:</span> <span class="s1">&#39;de&#39;</span><span class="p">,</span>
                     <span class="nx">minScore</span><span class="o">:</span> <span class="mf">0.75</span><span class="p">,</span>
                     <span class="nx">project_id</span><span class="o">:</span> <span class="s1">&#39;SOME_GCP_ID&#39;</span><span class="p">,</span>
                     <span class="nx">token</span><span class="o">:</span> <span class="s1">&#39;PATH_TO_SOME_TOKEN&#39;</span><span class="p">,</span>
                     <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;https://DIALOGFLOW-BASE-URL.com&#39;</span><span class="p">,</span>
                 <span class="p">},</span>
<span class="hll">                 <span class="nx">name_of_second_agent</span><span class="o">:</span> <span class="p">{</span>
</span><span class="hll">                     <span class="nx">defaultLifespan</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span class="hll">                     <span class="nx">executionIndex</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span class="hll">                     <span class="nx">languageCode</span><span class="o">:</span> <span class="s1">&#39;de&#39;</span><span class="p">,</span>
</span><span class="hll">                     <span class="nx">minScore</span><span class="o">:</span> <span class="mf">0.75</span><span class="p">,</span>
</span><span class="hll">                     <span class="nx">project_id</span><span class="o">:</span> <span class="s1">&#39;ANOTHER_GCP_ID&#39;</span><span class="p">,</span>
</span><span class="hll">                     <span class="nx">token</span><span class="o">:</span> <span class="s1">&#39;PATH_TO_ANOTHER_TOKEN&#39;</span><span class="p">,</span>
</span><span class="hll">                     <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;https://DIALOGFLOW-BASE-URL.com&#39;</span><span class="p">,</span>
</span><span class="hll">                 <span class="p">},</span>
</span>             <span class="p">},</span>
             <span class="nx">constructor</span><span class="o">:</span> <span class="nx">DialogflowAdapter</span><span class="p">,</span>
             <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;dialogflow&#39;</span><span class="p">,</span>
         <span class="p">},</span>
     <span class="p">},</span>
     <span class="nx">server</span><span class="o">:</span> <span class="p">{</span>
         <span class="nx">port</span><span class="o">:</span> <span class="mi">61133</span><span class="p">,</span> <span class="c1">// The port your bot listens on.</span>
     <span class="p">},</span>
     <span class="nx">interceptors</span><span class="o">:</span> <span class="p">{</span>
         <span class="nx">chatToCore</span><span class="o">:</span> <span class="nx">MirrorInterceptor</span><span class="p">.</span><span class="nx">getInstance</span><span class="p">,</span>
         <span class="nx">nlpToCore</span><span class="o">:</span> <span class="nx">MirrorInterceptor</span><span class="p">.</span><span class="nx">getInstance</span><span class="p">,</span>
         <span class="nx">nlpToNlp</span><span class="o">:</span> <span class="nx">MirrorInterceptor</span><span class="p">.</span><span class="nx">getInstance</span><span class="p">,</span>
     <span class="p">}</span>
 <span class="p">};</span>
</pre></div>
</td></tr></table></div>
<p>The second agent (the lines with the yellow background) is not necessarily required. We will talk about the use of this in the <a class="reference internal" href="#config-nlp"><span class="std std-ref">NLP Platform Configuration</span></a> section below.</p>
</div>
<div class="section" id="messaging-platform-configuration">
<h2>Messaging Platform Configuration<a class="headerlink" href="#messaging-platform-configuration" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">If you want to use another chat platform (e.g. Slack):</div>
<div class="line">First of all, change the imported adapter. In our example change line 1 and 3 from</div>
</div>
<div class="highlight-javascript notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="kr">import</span> <span class="p">{</span><span class="nx">Config</span><span class="p">,</span> <span class="nx">FacebookAdapter</span><span class="p">,</span> <span class="nx">DialogflowV2Adapter</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;emubot&#39;</span>
</span>
<span class="hll"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">config</span><span class="o">:</span> <span class="nx">Config</span><span class="o">&lt;</span><span class="nx">FacebookAdapter</span><span class="p">,</span> <span class="nx">DialogflowV2Adapter</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">{</span>
</span>    <span class="nx">platform</span><span class="o">:</span> <span class="p">{</span>
        <span class="p">....</span>
</pre></div>
</td></tr></table></div>
<p>to</p>
<div class="highlight-javascript notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="kr">import</span> <span class="p">{</span><span class="nx">Config</span><span class="p">,</span> <span class="nx">SlackAdapter</span><span class="p">,</span> <span class="nx">DialogflowV2Adapter</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;emubot&#39;</span>
</span>
<span class="hll"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">config</span><span class="o">:</span> <span class="nx">Config</span><span class="o">&lt;</span><span class="nx">SlackAdapter</span><span class="p">,</span> <span class="nx">DialogflowV2Adapter</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">{</span>
</span>    <span class="nx">platform</span><span class="o">:</span> <span class="p">{</span>
        <span class="p">....</span>
</pre></div>
</td></tr></table></div>
<p>Then change the configuration itself. Which variables you require depends on the messaging platform you use.</p>
<p>Supported platforms currently are</p>
<ol class="arabic simple">
<li><p>Facebook: use <code class="code docutils literal notranslate"><span class="pre">FacebookAdapter</span></code>. For more information regarding the configuration, see <a class="reference internal" href="chat_adapter/facebook_messenger.html#exemplar-fb-config"><span class="std std-ref">Exemplar Facebook Config</span></a>.</p></li>
<li><p>Slack: use <code class="code docutils literal notranslate"><span class="pre">SlackAdapter</span></code>. For more information regarding the configuration, see <a class="reference internal" href="chat_adapter/slack.html#exemplar-slack-config"><span class="std std-ref">Exemplar Slack Config</span></a>.</p></li>
</ol>
<p>If you want to support a different platform, take a look at <a class="reference internal" href="nlp_adapter/custom_nlp_adapter.html#custom-nlp-adapter"><span class="std std-ref">Support Your NLP Platform</span></a> and <a class="reference internal" href="chat_adapter/your_custom_chat_adapter.html#custom-chat-adapter"><span class="std std-ref">Support Your Chat Platform</span></a> respectively.</p>
</div>
<div class="section" id="nlp-platform-configuration">
<span id="config-nlp"></span><h2>NLP Platform Configuration<a class="headerlink" href="#nlp-platform-configuration" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">If you want to use another NLP platform (e.g. Rasa):</div>
<div class="line">Change the imported adapter and modify the respective variables. The changes are synonymous to the changes in the
messaging platform above. Currently we support</div>
</div>
<ol class="arabic simple">
<li><p>Dialogflow (API version 1): use <code class="code docutils literal notranslate"><span class="pre">DialogflowAdapter</span></code> (deprecated).</p></li>
<li><p>Dialogflow (API version 2): use <code class="code docutils literal notranslate"><span class="pre">DialogflowV2Adapter</span></code>. For more information regarding the configuration, see <a class="reference internal" href="nlp_adapter/dialogflow.html#exemplar-df-config"><span class="std std-ref">Exemplar Dialogflow Configuration</span></a>.</p></li>
<li><p>Rasa: use <code class="code docutils literal notranslate"><span class="pre">RasaAdapter</span></code>. For more information regarding the configuration, see <a class="reference internal" href="nlp_adapter/rasa.html#exemplar-rasa-config"><span class="std std-ref">Exemplar Rasa Configuration</span></a>.</p></li>
<li><p>Snips: use <code class="code docutils literal notranslate"><span class="pre">SnipsAdapter</span></code>. For more information regarding the configuration, see <a class="reference internal" href="nlp_adapter/snips.html#exemplar-snips-config"><span class="std std-ref">Exemplar Snips Configuration</span></a>.</p></li>
</ol>
</div>
<div class="section" id="multiple-agents">
<h2>Multiple agents<a class="headerlink" href="#multiple-agents" title="Permalink to this headline">¶</a></h2>
<p>Many chatbots are able to talk about different topics, e.g. perform smalltalk and offer an additional service that offers direct utility
(such as ordering a pizza). These topics can (and sometimes should) be separated into different <em>agents</em>. An agent
encompasses all the information required to fulfull user requests and is often also referred to simply as <em>the bot</em>.
But a bot as a whole can also include multiple agents, even if the user does not realize that different agents are
handling his requests. The <code class="code docutils literal notranslate"><span class="pre">emubot</span></code> framework allows you to send requests to multiple agents.</p>
<p>Each of your agents has an <code class="code docutils literal notranslate"><span class="pre">executionIndex</span></code>. The lower the index, the earlier a request will be sent to this agent.
The NLP service will then return a score between 0 and 1: If it is 100% sure that it can answer the query correctly,
it will return 1, otherwise it will return a value below 1. The higher the value, the higher is the confidence of the NLP service
that the query is classified correctly. This is why a <code class="code docutils literal notranslate"><span class="pre">minScore</span></code> is declared for each agent, which is a minimal threshold of
confidence the service has to have to accept the response and not ask a different agent.</p>
<p>Example for a <code class="code docutils literal notranslate"><span class="pre">minScore</span></code> of 0.6: If the NLU service returns a probability for an intent &gt;0.6: use the intent.
If the probability is &lt;0.6: send to next agent, determined by the <cite>executionIndex</cite>.</p>
</div>
<div class="section" id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Permalink to this headline">¶</a></h2>
<p>The tokens used to authenticate with the services are very senstive information.
You do not want to publish the respective strings or files in a public repository at any cost.
A good way to handle this is to use some CI/CD service (like <a class="reference external" href="https://docs.gitlab.com/ee/ci/">GitLab CI/CD</a>) to assemble the respective files.</p>
<p>Furthermore, separating the configuration file into multiple individual blocks/files can help you. Using this allows you to reuse
the same configuration for a specific platform, which also means that you only have to change it in one place afterwards.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="chat_adapter/facebook_messenger.html" class="btn btn-neutral float-right" title="Facebook Messenger" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="overview.html" class="btn btn-neutral float-left" title="Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, eMundo GmbH

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>